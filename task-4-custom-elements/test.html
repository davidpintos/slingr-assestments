<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>AdpStatusWidget Component Tests</title>
    <script src="adp-status-widget.js" defer></script>
  </head>
  <body>
    <script>
      /**
       * Function to test different conditions, receives the condition to test and a message
       */
      function testCondition(condition, message) {
        if (condition) {
          console.log("Test passed:", message);
        } else {
          console.log("Test failed:", message);
        }
      }

      window.addEventListener('DOMContentLoaded', () => {
          console.log("Starting tests...");

          // It checks component is defined
          testCondition(customElements.get("adp-status-widget"), "Component is defined");

          // Setup
          const adpStatus = document.createElement("adp-status-widget");
          document.body.appendChild(adpStatus);
          const shadow = adpStatus.shadowRoot;

          // It checks default value is fine
          const widgetValue = shadow.querySelector(".value");
          testCondition(
            widgetValue && widgetValue.textContent === "0",
            "default value is 0"
          );

          // It checks default label is right
          const widgetLabel = shadow.querySelector(".label");
          testCondition(
            widgetLabel && widgetLabel.textContent === "Label",
            "default label is applied"
          );

          // Setting some new values for testing...
          adpStatus.setAttribute("value", "10");
          adpStatus.setAttribute("label", "Tasks");
          adpStatus.setAttribute("status", "Rejected");

          // It checks the value is updated properly
          testCondition(
            shadow.querySelector(".value").textContent === "10",
            "value updates when attribute changes"
          );

          // It checks the status text is updated properly
          testCondition(
            shadow.querySelector(".status-text").textContent === "Rejected",
            "Status text changed"
          );

          // It checks the icon shown is the right one
          testCondition(
            shadow.querySelector(".icon").textContent === "!",
            "Rejected status uses correct icon"
          );

          console.log("Finishing tests");
      });
    </script>
  </body>
</html>
